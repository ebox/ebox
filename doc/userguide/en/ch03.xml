<chapter id="ch-network">

	<title>Network Configuration</title>

	<section id='sect-ebox-interfaces'>
		<!-- Network->Interfaces -->
		<title>Network interfaces</title>

		<para>You can enter into network interfaces
		configuration at 
			<menuchoice>
				<guimenu>Network</guimenu>
				<guimenuitem>Interfaces</guimenuitem>
			</menuchoice>
		at the left menu.
		</para>

		<para>For each network interface we can choose a new name and its
		configuration. Available configurations are:
		</para>

		<variablelist>
			<varlistentry>
				<term>Static</term>
				<listitem>
					<para>It will assign permanently an IP address
					to the network interface. Once you have
					chosen the configuration, you can set if
					this network interface is
					external<footnote><para><!--FIXME--></para></footnote>,
					its IP address and its network mask.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>DHCP</term>
				<listitem>
					<para>When you select this option for
					configuration, the network interface will be
					configured dynamically if a DHCP Server exists
					on the network. The only configuration
					parameter is the ability to be an external
					interface.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Trunk 802.1Q</term>
				<listitem>
					<para><!--FIXME--></para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Not configured</term>
				<listitem>
					<para>Network interface won't be configured.</para>
				</listitem>
			</varlistentry>
		</variablelist>

		<section>
			<title>Virtual interfaces</title>
			<para>
			A virtual interface is the one which is
			attached to a real one, and it is used to
			listen or serve another IP address apart from
			the real one, that is, the real interface can
			assist two or more networks just creating as
			many virtual interfaces as needed.
			</para>
			<para>It's possible to create new virtual interfaces bound to
			any interface configured as static.</para>
			<para>Once you have configured static interface, a form will
			be shown to add virtual interfaces, where you can assign their
			name, IP address and network mask.
			</para>
		</section>

	</section>

	<section id='sect-ebox-dns'>
		<!-- Network->DNS -->
		<title>DNS Servers</title>

		<para>You can set IP addresses for the DNS Server that you want to use
		to solve host names. You have to remember that, if your network
		interfaces are configured with DHCP, your network settings could be
		overwritten.</para>
	</section>

	<section id='sect-ebox-routes'>
		<!-- Network->Routes -->
		<title>Routes</title>

		<para>You can access to Routes configuration through
			<menuchoice>
				<guimenu>Network</guimenu>
				<guimenuitem>Routes</guimenuitem>
			</menuchoice>.
		</para>

		<section>
			<title>Default gateway</title> 
			<para>Default gateway will be,
			usually, your router IP address.</para>
		</section>

		<section>
			<title>Static routes</title>
			<para><!--FIXME--></para>
		</section>
	</section>

	<section id='sect-ebox-diagnostics'>
		<!-- Network->Diagnostics -->
		<title>Diagnostic tools</title>

		<para>You can use this tools to check if your network settings are
		correct.</para>

		<para>
		Selecting
			<menuchoice>
				<guimenu>Network</guimenu>
				<guimenuitem>Diagnostics</guimenuitem>
			</menuchoice>
		you could make a ping to a reachable host through your network
		interfaces, or you can resolve a domain name.</para>

		<para>The output of this operations will be shown on this page,
		corresponding with the standard output of the GNU/Linux commands
		<command>ping</command> and <command>dig</command>.</para>
	</section>

	<section id='sect-gateways'>
	  <!-- Network->Gateways -->
	  <title>Gateways</title>
	  
	  <para>
	    Through this section you can set the gateways where your network traffic is
	    directed. It is very useful in order to split or do balance your Internet traffic.
	  </para>

	  <para>
	    Choosing 
	    <menuchoice>
	      <guimenu>Network</guimenu>
	      <guimenuitem>Gateways</guimenuitem>
	    </menuchoice>
	    you could add as many gateways as you want. The following attributes are needed to
	    be to each gateway added:
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Name</term>
	      <listitem>
		<para>
		  It is the logical name associated to the gateway in eBox which is used in
		  the other eBox parts. It should be unique.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>IP Address</term>
	      <listitem>
		<para>
		  The static gateway IP address.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Interface</term>
	      <listitem>
		<para>
		  The interface from where the gateway is reachable. That is, it is the interface
		  where packets can be routed to get the gateway.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Upload</term>
	      <listitem>
		<para>
		  The maximum upload rate (in <emphasis>Kilobits per second</emphasis>) you can
		  have towards the connection from eBox to the gateway.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Download</term>
	      <listitem>
		<para>
		  The maximum download rate (in <emphasis>Kilobits per second</emphasis>) you can
		  obtain towards the connection from the gateway to eBox
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Weight</term>
	      <listitem>
		<para>
		  It is the weight associated to this gateway. It is used by 
		  <link linkend="subsect-balance-traffic">balance traffic section</link> to apply
		  special rules applied to multiple gateways.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Default</term>
	      <listitem>
		<para>
		  It is set to determine whether the gateway is the default one or not. This
		  implies each packet which has no rule that indicates which gateway should
		  be directed to, will be delivered to reach the default gateway. <emphasis>
		  Just one</emphasis> gateway can be the default one.
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	  
	  <warning>
	    <para>
	      Each gateway should be reachable from at least one interface. eBox checks so
	      for each interface whose configuration is static. If the interface is configured
	      via DHCP this check is skipped since it is impossible to determine.
	    </para>
	  </warning>

	  <para>
	    The correct values for upload and download rate are critical to ensure the correct
	    functionality from <link linkend="ch-trafficshaping">traffic shaping module</link>.
	  </para>

	  <para>
	    Once you have added a gateway, it will appear at the <guilabel>Gateway list</guilabel>
	    . Then, you can delete it or edit the values set previously through the icons which
	    appear on the right side of the list.
	  </para>

	</section>

	<section id="sect-balance-traffic">
	  <title>Balance traffic and multigateway rules</title>

	  <section id="sect-requirements">
	    <title>Requirements</title>
	    <para>
	      In order to have these two features, you need at least two gateways configured.
	    </para>
	  </section>

	  <section id="subsect-balance-traffic">
	    <title>Balance traffic</title>
	    <para>
	      You can enable <emphasis>traffic balancing</emphasis> via
	      <guimenu>Network</guimenu>
	      <guimenuitem>Balance traffic</guimenuitem>
	      in order to share your traffic through different routes. The traffic distribution
	      relies on a weigthed sum from the gateway weights which are set on gateway attributes 
	      (See <link linkend="sect-gateways">Gateways section</link> to know how configured them).
	    </para>

	    <para>
	      A typical configuration could be following: you have two gateways configurated where one 
	      has the double rate capacity (A) than the other one (B), thus you may want to balance traffic in 
	      2:1 proportion, that is, gateway A will deliver the double traffic than B. To achieve so, you need 
	      to set the weight parameter to A to 2 and gateway B will have weight set to 1.
	    </para>
	  </section>
	  
	  <section id="sect-multigateway-rules">
	    <title>Multigateway rules</title>
	    <para>
	      It may be needed to route explicitily traffic by a certain gateway, to do so, you should
	      use the multigateway rules which mark the packets to be delivered through the gateway selected.
	    </para>

	</section>

</chapter>
