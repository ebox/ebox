<chapter id="ch-services">
  <title>Network services</title>
  <section id='sect-serv-desc'>
    <title>Network services in eBox</title>
    <para>
      As it happened in <xref linkend="ch-objects"/>, the network
      services are an abstraction to ease the management of your
      network. Each network service describes a set of ports for
      Internet protocols where service accepts requests. Providing a
      name plus an optional description allows
      you to manage the network service policies more intuitively and
      less error-prone.
    </para>
    <para>
      The network services are used by firewall module (<xref
      linkend="ch-firewall"/>) and traffic shaping module (<xref
      linkend="ch-trafficshaping"/>). Anyway, as eBox philosophy every
      feature which use a network service must use this module to work
      with and ease the administration life.
    </para>
  </section>
  <section id="sect-services-manage">
    <title>Network services management</title>
    <para>
      In order to get the network service management you may go to
      <menuchoice>
        <guimenu>Services</guimenu>
      </menuchoice>.
    </para>
    <para>
      As you may notice, there are several services which
      have been created by eBox for you. These services are used by
      eBox modules afterwards. For instance, <emphasis>dhcp</emphasis>
      service is described as an internal service called
      '<emphasis>Dynamic Host Configuration Protocol</emphasis>'.This
      service is read-only as it is already
      managed by dhcp module automatically. Each service has a
      configuration where the service protocol, well-known source and
      destination ports are set. There are three special services
      which define the generic abstraction for every service
      (<emphasis>any</emphasis>) and every TCP/UDP service. They are
      entered to handle easily rules defined in other modules that
      depends on this network services.
    </para>
    <para>
      You may input a new service with these following elements:
      <variablelist>
        <varlistentry>
          <term>Service name</term>
          <listitem><para>The name for the service which refers
          uniquely this service in the system</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>Description</term>
          <listitem><para>This field defines the verbose description
          for the network service to ease the administration
          management. It is an optional field.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>Internal</term>
          <listitem><para>When a network service is set as internal,
          those protocol/port pairs that owns this service will be set
          as busy, that is not available for others services to
          use.</para></listitem>
        </varlistentry>
        <varlistentry>
          <term>Configuration</term>
          <listitem>
            <para>The service configuration is a multiple value
            configuration setting which may contain these three
            elements:</para>
            <variablelist>
              <varlistentry>
                <term>Protocol</term>
                <listitem><para>The Internet protocol which may set
                one of these values: TCP/UDP, TCP, UDP, GRE, ICMP or
                "any". If the protocol is set to GRE or ICMP, then it is
                banned to set any port since it is banned by protocol
                construction</para></listitem>
              </varlistentry>
              <varlistentry>
                <term>Source port</term>
                <listitem>
                  <para>A well-known source port may contain
                  one of the following:</para>
                  <itemizedlist>
                    <listitem><formalpara>
                      <title>Any</title><para>Indicates any port for
                      that protocol or set of them</para></formalpara>
                    </listitem>
                    <listitem><formalpara><title>Single
                    port</title><para>Indicates a single port for
                    that protocol or set of them</para></formalpara>
                    </listitem>
                    <listitem><formalpara><title>Port range</title><para>Indicates a port
                    range including all of them for
                    that protocol or set of them</para></formalpara>
                    </listitem>
                  </itemizedlist>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>Destination port</term>
                <listitem><para>Analogously with source port, the same
                elements appear in destination port.</para></listitem>
              </varlistentry>
            </variablelist>
          </listitem>
        </varlistentry>
      </variablelist>
      You might inspect several system-defined services prior to add
      your own ones. Anyway, a user-defined service may be created
      when additional network services be installed on top of an eBox
      installation, for example introducing <emphasis>FTP (File
      Transfer Protocol)</emphasis> service.
    </para>
    <example id="serv-conf-example">
      <title>Service configuration example</title>
      <itemizedlist>
        <listitem><formalpara><title>Service name</title><para>ftp</para></formalpara></listitem>
        <listitem><formalpara><title>Description</title><para>File Transfer Protocol</para></formalpara></listitem>
        <listitem><formalpara><title>Internal</title><para>yes</para></formalpara></listitem>
        <listitem>
          <formalpara>
            <title>Configuration:</title>
            <para>
              <itemizedlist>
                <listitem><para>
                  protocol: tcp, source port: any, destination port:
                  20 (<emphasis>Define the control connection channel</emphasis>) </para>
                </listitem>
                <listitem>
                  <para>protocol: tcp, source port: any,
                  destination port: 21 (<emphasis>Define the data flow connection
                  channel</emphasis>)</para>
                </listitem>
              </itemizedlist>
            </para>
          </formalpara>
        </listitem>
      </itemizedlist>
    </example>

  </section>
</chapter>
